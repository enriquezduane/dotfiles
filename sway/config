# Variables
set $mod Mod4
set $term foot
set $launcher fuzzel
set $browser firefox
# set $editor lite-xl

# Fast repeat rate for keyboard-centric workflow.
# Swap left alt with left ctrl
# Swap caps with escape
input * {
    repeat_delay 200
    repeat_rate 40
    xkb_options ctrl:swap_lalt_lctl,caps:swapescape
}

# Touchpad
input type:touchpad {
    dwt disabled
    tap enabled
    natural_scroll enabled
}

# TrackPoint
input "2:10:TPPS/2_Elan_TrackPoint" {
    accel_profile flat
}

# Set the wallpaper. Fallback to solid dark grey if image is missing.
output * bg ~/Pictures/Wallpapers/current.png fill #272e33

# --- Visuals (Everforest Dark Hard) ---
default_border pixel 3
gaps inner 10
gaps outer 5

font pango:IBM Plex Sans 11

# Class                 Border  Background Text     Indicator ChildBorder
client.focused          #a7c957 #a7c957    #272e33  #a7c957   #a7c957
client.focused_inactive #3a464c #3a464c    #d3c6aa  #3a464c   #3a464c
client.unfocused        #272e33 #272e33    #859289  #272e33   #272e33
client.urgent           #e67e80 #e67e80    #272e33  #e67e80   #e67e80

#  Keybindings: App Launchers
bindsym $mod+Return exec $term
bindsym $mod+d exec $launcher
bindsym $mod+w exec $browser
# bindsym $mod+e exec $editor ~

# Keybindings: Window Management
bindsym $mod+q kill
bindsym $mod+Shift+c reload

# Toggle Waybar (useful for distraction-free mode)
bindsym $mod+b exec pkill waybar || waybar

# Keybindings: Workspaces
bindsym $mod+1 workspace number 1
bindsym $mod+2 workspace number 2
bindsym $mod+3 workspace number 3
bindsym $mod+4 workspace number 4
bindsym $mod+5 workspace number 5

bindsym $mod+Shift+1 move container to workspace number 1
bindsym $mod+Shift+2 move container to workspace number 2
bindsym $mod+Shift+3 move container to workspace number 3
bindsym $mod+Shift+4 move container to workspace number 4
bindsym $mod+Shift+5 move container to workspace number 5

bindsym $mod+Tab workspace back_and_forth

# Keybindings: Hardware & System

# Brightness (Using --locked allows control even when screen is locked)
bindsym --locked XF86MonBrightnessDown exec brightnessctl set 5%-
bindsym --locked XF86MonBrightnessUp exec brightnessctl set +5%

# Audio (Pipewire/Wireplumber)
bindsym XF86AudioRaiseVolume exec wpctl set-volume -l 1.0 @DEFAULT_AUDIO_SINK@ 5%+
bindsym XF86AudioLowerVolume exec wpctl set-volume @DEFAULT_AUDIO_SINK@ 5%-
bindsym XF86AudioMute exec wpctl set-mute @DEFAULT_AUDIO_SINK@ toggle

# Screenshots (Grim + Slurp)

# Print Screen: Select area -> Save to Downloads
bindsym Print exec grim -g "$(slurp)" ~/Downloads/shot_$(date +'%H%M%S').png
# Fn+Print (XF86Selective): Select area -> Clipboard
bindsym XF86SelectiveScreenshot exec grim -g "$(slurp)" - | wl-copy

# Custom LLM Snippet Picker
bindsym Insert exec cat ~/.config/sway/llm.txt | fuzzel --dmenu --width 60 --prompt ">  " | awk -F '\t' '{print $2}' | wl-copy

# Gestures (Requires wtype)
# 3-finger swipe for Firefox tabs (simulating Ctrl+Tab)
bindgesture swipe:3:right exec wtype -M ctrl -k Tab -m ctrl
bindgesture swipe:3:left exec wtype -M ctrl -M shift -k Tab -m shift -m ctrl

# Autostart & Idle
# Start Waybar immediately
exec_always pkill waybar; waybar

# Idle Daemon
exec_always pkill swayidle || true; swayidle -w \
    timeout 300 'swaylock -f' \
    timeout 600 'swaymsg "output * dpms off"' \
    resume 'swaymsg "output * dpms on"' \
    before-sleep 'swaylock -f'
